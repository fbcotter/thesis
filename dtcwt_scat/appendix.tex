\chapter{Architecture Used for Experiments} \label{app:arch}
Something

\chapter{Forward and Backward Algorithms} \label{app:ch3:fwd_bwd}
We have listed some of the forward and backward algorithms here that are not
included in the main text for the interested reader.

\begin{algorithm}[h!]
\caption{2-D Inverse DWT and its gradient}\label{alg:ch3:idwt}
\begin{algorithmic}[1]
\Function{AG:IDWT:FWD}{$ll,\ lh,\ hl,\ hl,\ g_0,\ g_1,\ mode$}
  \State \textbf{save} $g_0,\ g_1,\ mode$ \Comment{For the backwards pass} \label{line:ch3:idwt_save}
  \State $lo \gets \F{sfb1d}(ll,\ lh,\ g_0,\ g_1,\ mode,\ axis=-2) $
  \State $hi \gets \F{sfb1d}(hl,\ hh,\ g_0,\ g_1,\ mode,\ axis=-2) $
  \State $x \gets \F{sfb1d}(lo,\ hi,\ g_0,\ g_1,\ mode,\ axis=-1) $
  \State \textbf{return} $x$
\EndFunction
\end{algorithmic}\vspace{10pt}
\begin{algorithmic}[1]
\Function{AG:IDWT:BWD}{$\delta y$}
  \State \textbf{load} $g_0,\ g_1,\ mode$
  \State $ g_0,\ g_1 \gets \F{flip}(g_0),\ \F{flip}(g_1) $\Comment{flip the filters as in \eqref{eq:ch3:backprop}}
  \State $\Delta lo,\ \Delta hi \gets \F{afb1d}(\delta y,\ g_0,\ g_1,\ mode,\ axis=-2)$ 
  \State $\Delta ll,\ \Delta lh \gets \F{afb1d}(\Delta lo,\ g_0,\ g_1,\ mode,\ axis=-1)$ 
  \State $\Delta hl,\ \Delta hh \gets \F{afb1d}(\Delta hi,\ g_0,\ g_1,\ mode,\ axis=-1)$ 
  \State \textbf{return} $\Delta ll,\ \Delta lh,\ \Delta hl,\ \Delta hh$
\EndFunction
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[tb]
\caption{Smooth Magnitude}\label{alg:ch3:mag_smooth}
\begin{algorithmic}[1]
\Function{AG:MAG\_SMOOTH:FWD}{$x,\ y,\ b$}
  \State $b \gets \max(b,\ 0)$
  \State $r \gets \sqrt{x^2 + y^2 + b^2}$
  \State $\dydx{r}{x} \gets \frac{x}{r}$
  \State $\dydx{r}{y} \gets \frac{y}{r}$
  \State \textbf{save} $\dydx{r}{x},\ \dydx{r}{x}$
  \State \textbf{return} $r - b$
\EndFunction
\end{algorithmic}\vspace{10pt}
\begin{algorithmic}[1]
\Function{AG:MAG\_SMOOTH:BWD}{$\Delta r$}
  \State \textbf{load} $\dydx{r}{x},\ \dydx{r}{y}$
  \State $\Delta x \gets \Delta r \dydx{r}{x}$
  \State $\Delta y \gets \Delta r \dydx{r}{y}$
  \State \textbf{return} $\Delta x,\ \Delta y$
\EndFunction
\end{algorithmic}
\end{algorithm}

\begin{algorithm}[tb]
\caption{Q2C}\label{alg:ch3:q2c}
\begin{algorithmic}[1]
\Function{MOD:Q2C}{$x,\ y,\ b$}
  \State $b \gets \max(b,\ 0)$
  \State $r \gets \sqrt{x^2 + y^2 + b^2}$
  \State $\dydx{r}{x} \gets \frac{x}{r}$
  \State $\dydx{r}{y} \gets \frac{y}{r}$
  \State \textbf{save} $\dydx{r}{x},\ \dydx{r}{x}$
  \State \textbf{return} $r - b$
\EndFunction
\end{algorithmic}\vspace{10pt}
\end{algorithm}
